<div>
  <!-- Inputs para agregar un nuevo medio -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h6 class="mb-0">Medios de Verificación</h6>
    {% if user.role_id == 10 %}
    <a class="btn btn-sm btn-primary add-verification" href="/actividades/crear-verificacion/"> <i class="bi bi-plus-lg"></i> Crear </a>
    {% endif %}
  </div>
  <!-- Lista de medios de verificación existentes -->
  <ul class="verification-list list-group list-group-flush">
    {% for verificacion in verificaciones %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        <strong>{{ verificacion.nombre }}:</strong>
        <a href="{{ verificacion.url }}" target="_blank">{{ verificacion.url }}</a>
      </span>
      <span class="verification-actions">
        {% if user.role_id == 10 %}
        <a class="btn btn-sm btn-warning edit-verification" href="/actividades/editar-verificacion/{{ verificacion.verificacion_id }}/"> <i class="bi bi-pencil"></i> Editar </a>
        <button class="btn btn-sm btn-danger delete-verification" data-verificacion-id="{{ verificacion.verificacion_id }}" data-verificacion-nombre="{{ verificacion.nombre }}">
          <i class="bi bi-trash"></i> Eliminar
        </button>
        {% endif %}
      </span>
    </li>
    {% endfor %}
  </ul>

  <!-- Formulario oculto para eliminar verificaciones (POST request) -->
  <form id="deleteVerificacionForm" method="POST" style="display: none">{% csrf_token %}</form>
</div>

<script>
  // Script para eliminar verificaciones con confirmación
  document.addEventListener("DOMContentLoaded", function () {
    const deleteVerificacionForm = document.getElementById("deleteVerificacionForm");

    // Delegación de eventos para los botones de eliminar
    document.addEventListener("click", function (e) {
      const deleteBtn = e.target.closest(".delete-verification");

      if (deleteBtn) {
        e.preventDefault();

        const verificacionId = deleteBtn.getAttribute("data-verificacion-id");
        const verificacionNombre = deleteBtn.getAttribute("data-verificacion-nombre");

        // Mostrar confirmación
        if (confirm(`¿Seguro que quieres eliminar el medio de verificación "${verificacionNombre}"?`)) {
          // Configurar el formulario para hacer POST
          deleteVerificacionForm.action = `/actividades/eliminar-verificacion/${verificacionId}/`;

          // Enviar el formulario
          deleteVerificacionForm.submit();
        }
      }
    });
  });
</script>
